/*
 *  jquery.validator2.js
 *
 *  Plugin: Validator
 *  Author: biohzrdmx
 *  Description: A very simple form validation plugin
 *  Version: 2.5 (20130720)
 *  License: MIT
 */
;;(function($){$.validator={rules:[],init:function(options){return this},ltrim:function(stringToTrim){return stringToTrim.replace(/^\s+/,"")},rtrim:function(stringToTrim){return stringToTrim.replace(/\s+$/,"")},validate:function(options){var validator=this;var opts=$.extend({rules:[],form:null,success:validator.onSuccess,error:validator.onError},options);var error=0;var email=/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;var fields=[];var elem= null;var form=null;var val=null;var ptr=this;if(opts.form===null)return false;if(typeof opts.form=="string")form=$(options.form);else form=opts.form;var ruleSet=opts.rules.length>0?opts.rules:this.rules;for(var i=0;i<ruleSet.length;i++){rule=ruleSet[i];if(typeof rule.el=="string")elem=$(rule.el);else elem=rule.el;if(elem===undefined||elem===null)continue;if(!elem.parents("form").is(form))continue;switch(rule.type){case "required":try{elem.each(function(){el=$(this);if(el.is(":disabled"))return;val= ptr.ltrim(ptr.rtrim(el.val()));if(el.is(":checkbox ")&&!el.is(":checked")||el.is(":radio")&&$("input[name="+el.attr("name")+"]:checked").length==0||val==""){error++;fields.push(el)}})}catch(err){}break;case "email":try{elem.each(function(){el=$(this);if(el.is(":disabled"))return;if(!email.test(el.val())){error++;fields.push(el)}})}catch(err){}break;case "regex":try{elem.each(function(){el=$(this);if(el.is(":disabled"))return;if(rule.param===null||!rule.param.test(el.val())){error++;fields.push(el)}})}catch(err){}break; case "equal":try{elem.each(function(){el=$(this);var compare=null;if(typeof rule.param=="string")compare=$(rule.param);else compare=rule.param;if(el.is(":disabled")||compare.is(":disabled"))return;if(compare===null||el.val()==""||el.val()!==compare.val()){error++;fields.push(el)}})}catch(err){}break;case "checkboxes":try{elem.each(function(){el=$(this);if(el.is(":disabled"))return;var group=el.attr(rule.param);if(el.is(":checkbox")&&$("input["+rule.param+'="'+group+'"]:checked').length==0){error++; fields.push(el)}})}catch(err){}break;case "at least":case "at most":try{var localFields=[];var count=0;elem.each(function(){el=$(this);if(el.is(":disabled"))return;val=ptr.ltrim(ptr.rtrim(el.val()));localFields.push(el);if(el.is(":checkbox ")&&!el.is(":checked")||el.is(":radio")&&$("input[name="+el.attr("name")+"]:checked").length==0||val=="");else count++});if(rule.type=="at least"&&count<rule.param){error++;fields=fields.concat(localFields)}else if(rule.type=="at most"&&count>rule.param){error++; fields=fields.concat(localFields)}}catch(err){}break;case "date":try{var isValid=true;elem.each(function(){el=$(this);if(el.is(":disabled"))return;val=ptr.ltrim(ptr.rtrim(el.val()));if(val==""){error++;fields.push(el);isValid=false}});if(elem.length==3&&elem.is("select")){if(rule.param&&isValid){var year=elem.filter("select[data-name=year]");var month=elem.filter("select[data-name=month]");var day=elem.filter("select[data-name=day]");var dateArr=[year.val(),month.val(),day.val()];var checkArr=rule.param.split("/"); var date=new Date(dateArr[0],--dateArr[1],dateArr[2]);var check=new Date(checkArr[0],--checkArr[1],checkArr[2]);if(rule.val=="before"&&date.getTime()>=check.getTime()){fields.push(year);fields.push(month);fields.push(day);error+=3}else if(rule.val=="after"&&date.getTime()<=check.getTime()){fields.push(year);fields.push(month);fields.push(day);error+=3}}}else if(elem.is("input"))if(rule.param&&isValid)elem.each(function(){var el=$(this);var dateStr=el.val();var dateArr=dateStr.split("/");var checkArr= rule.param.split("/");var date=new Date(dateArr[0],--dateArr[1],dateArr[2]);var check=new Date(checkArr[0],--checkArr[1],checkArr[2]);if(rule.val=="before"&&date.getTime()>=check.getTime()){fields.push(el);error++}else if(rule.val=="after"&&date.getTime()<=check.getTime()){fields.push(el);error++}})}catch(err){}break}}if(error>0){opts.error.call(form,$(fields));return false}else if(error==0){ret=opts.success.call(form);return true}},addRule:function(options){var validator=this;var opts=$.extend({el:null, type:"required",msg:null,attr:null,param:null,before:null,after:null,to:null,match:null,auto:false},options);if(opts.el!==null){var rule={el:opts.el,type:opts.type,msg:opts.msg,param:opts.param||opts.to||opts.match||opts.before||opts.after,val:null};switch(opts.type){case "date":rule.val=opts.before?"before":opts.after?"after":null;break;default:}if(opts.auto){var el=typeof opts.el=="string"?$(opts.el):opts.el;el.on("blur",function(){validator.validate({form:el.closest("form"),rules:[rule],error:validator.onError, success:function(){validator.onSuccess.call(validator,el)}})})}this.rules.push(rule)}},onSuccess:function(fields){},onError:function(fields){}}})(jQuery);;